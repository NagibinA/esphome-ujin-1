# https://stuvel.eu/post/2022-06-05-esphome-touch-dimmer/
substitutions:
  name: lume
  device_description: luxe L.te M1
  light_1_device: light.kithen1
  light_2_device: light.kithen2
  sda_i2c: GPIO7
  scl_i2c: GPIO8
  beeper_ledc: GPIO32

esphome:
  name: "${name}"
  comment: "${device_description}"
  platformio_options:
    board_upload.maximum_size: 7864320
               
api:
  reboot_timeout: 0s     
  
esp32:
  board: denky_d4
  flash_size: 8MB
  framework:
    type: arduino
    
#-------------------------------------------
# PSRAM
#-------------------------------------------
psram:
  mode: quad
  speed: 80MHz

#-------------------------------------------
# I2c
#-------------------------------------------
i2c:
  sda:
    number: $sda_i2c
    ignore_pin_validation_error: true
  scl: 
    number: $scl_i2c
    ignore_pin_validation_error: true
  scan: true

#-------------------------------------------
# PACKAGES
#-------------------------------------------
packages:
  wifi: !include packages/wifi.yaml
  web: !include included/web.yaml
  device_base: !include packages/device_base.yaml

  but: !include 
    file: packages/lume/button.yaml
    vars:
      one_butt: GPIO15
      two_butt: GPIO2

# Двойной выключатель для lume Luxe L.te M1
  zero_dimm: !include 
    file: packages/lume/zero_dimm.yaml
    vars:
      dimmer1_zero: GPIO5 
      dimmer2_zero: GPIO5
      dimmer1_gate: GPIO19  
      dimmer2_gate: GPIO25  
      type_light1: monochromatic # binary
      type_light2: monochromatic # binary

# Один встроенный, второй удаленный  прямое управление через BLE люстрой на 2 канале !!!!zero_dimm  убрать!!!! для lume Luxe L.te M1
#  ble_adv: !include 
#    file: packages/lume/ble_adv_controller.yaml
#    vars:
#      variant_light: v1
#      encoding_light: lampsmart_pro
#      dimmer1_zero: GPIO5 
#      dimmer1_gate: GPIO19  
#      type_light1: monochromatic # binary
#      type_light2: monochromatic # binary
      
 # time: !include included/time.yaml
  esp32_temp: !include packages/sensor/esp32_temp.yaml
#  cap: !include 
#    file: packages/lume/captive.yaml
#    vars:
#      ssid_captive: "Lume"
#      pass_captive: "12345678"

  zigbee: !include 
    file: packages/lume/zigbee.yaml
    vars:
      TX_Z: 27
      RX_Z: 14

  led: !include 
    file: packages/lume/led_lume.yaml
    vars:
      led_lume_pin: GPIO26
      led_lume: 5
  2in: !include 
    file: packages/lume/2in.yaml
    vars:
      one_pin: GPIO33
      two_pin: GPIO3
#  1in: !include 
#    file: packages/lume/1in.yaml
#    vars:
#      one_pin: GPIO33


#-------------------------------------------
# OUTPUT
#-------------------------------------------      
output:
  - platform: ledc
    pin: $beeper_ledc
    id: rtttl_out

#-------------------------------------------
# RTTTL
#-------------------------------------------
rtttl:
  output: rtttl_out
  gain: 60%

#-------------------------------------------
# SWITCH
#-------------------------------------------
switch:
  - platform: template
    name: "Звук нажатие клавиш"
    optimistic: True
    id: sound
    entity_category: config
    restore_mode: RESTORE_DEFAULT_ON
    icon: mdi:volume-off
